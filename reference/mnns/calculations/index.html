
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../dynamics/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>mnns.calculations - MemNNetSim</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mnns.calculations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MemNNetSim" class="md-header__button md-logo" aria-label="MemNNetSim" data-md-component="logo">
      
  <img src="../../../assets/icons/mnns-icon-light.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MemNNetSim
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mnns.calculations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/marcus-k/MemNNetSim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    marcus-k/MemNNetSim
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MemNNetSim" class="md-nav__button md-logo" aria-label="MemNNetSim" data-md-component="logo">
      
  <img src="../../../assets/icons/mnns-icon-light.svg" alt="logo">

    </a>
    MemNNetSim
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/marcus-k/MemNNetSim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    marcus-k/MemNNetSim
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../attributes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NWN Attributes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>mnns
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>mnns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>calculations
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>calculations
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.create_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.get_connected_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_connected_nodes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.scale_sol" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;scale_sol
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_drain_current" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_drain_current
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_edge_current" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_edge_current
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_network" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_nodal_current" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_nodal_current
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fromtext/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>fromtext
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../line_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>line_functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nanowire_network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>nanowire_network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nanowires/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>nanowires
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>plotting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../units/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>units
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.create_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.get_connected_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_connected_nodes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.scale_sol" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;scale_sol
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_drain_current" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_drain_current
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_edge_current" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_edge_current
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_network" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mnns.calculations.solve_nodal_current" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solve_nodal_current
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div class="doc doc-object doc-module">



<h1 id="mnns.calculations" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">mnns.calculations</span>


<a href="#mnns.calculations" class="headerlink" title="Permanent link">&para;</a></h1>

    <div class="doc doc-contents first">

        <p>Functions to statically solve nanowire networks.</p>












<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            create_matrix (mnns.calculations.create_matrix)" href="#mnns.calculations.create_matrix">create_matrix</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Create the Laplacian connectivity matrix.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_connected_nodes (mnns.calculations.get_connected_nodes)" href="#mnns.calculations.get_connected_nodes">get_connected_nodes</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a list of nodes which are connected to any of the given nodes.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            scale_sol (mnns.calculations.scale_sol)" href="#mnns.calculations.scale_sol">scale_sol</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Scale the voltage and current solutions by their characteristic values.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            solve_drain_current (mnns.calculations.solve_drain_current)" href="#mnns.calculations.solve_drain_current">solve_drain_current</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Solve for the current through each drain node of a NWN.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            solve_edge_current (mnns.calculations.solve_edge_current)" href="#mnns.calculations.solve_edge_current">solve_edge_current</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Solve for the current passing through each edge of a NWN. The direction is</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            solve_network (mnns.calculations.solve_network)" href="#mnns.calculations.solve_network">solve_network</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Solve for the voltages of each node in a given NWN. Each drain node will</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            solve_nodal_current (mnns.calculations.solve_nodal_current)" href="#mnns.calculations.solve_nodal_current">solve_nodal_current</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Solve for the current entering each node of a NWN. Only the entering</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>





  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="mnns.calculations.create_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_matrix</span>


<a href="#mnns.calculations.create_matrix" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_matrix</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;conductance&quot;</span><span class="p">,</span>
    <span class="n">source_nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">drain_nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ground_nodes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create the Laplacian connectivity matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>NWN</code>
            </td>
            <td>
                  <code><span title="Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nanowire network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value_type</code>
            </td>
            <td>
                  <code>(&#39;conductance&#39;, &#39;capacitance&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight to use for the Laplacian matrix. Default: "conductance".</p>
              </div>
            </td>
            <td>
                  <code>&#34;conductance&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_nodes</code>
            </td>
            <td>
                  <code>list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only needed if ground_nodes is True to find which nodes are to be
grounded. Default: None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drain_nodes</code>
            </td>
            <td>
                  <code>list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a drain node is supplied, the row and column corresponding to
the drain node are zeros and a one is placed at the row-column
intersection. Default: None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ground_nodes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, a small value is added to the main diagonal to avoid
singular matrices. Default: False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>M</code></td>            <td>
                  <code><span title="csr_matrix">csr_matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resultant sparse Laplacian matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>mnns/calculations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_matrix</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;conductance&quot;</span><span class="p">,</span>
    <span class="n">source_nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">drain_nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ground_nodes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the Laplacian connectivity matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    NWN : Graph</span>
<span class="sd">        Nanowire network.</span>

<span class="sd">    value_type : {&quot;conductance&quot;, &quot;capacitance&quot;}, optional</span>
<span class="sd">        Weight to use for the Laplacian matrix. Default: &quot;conductance&quot;.</span>

<span class="sd">    source_nodes : list of tuples, optional</span>
<span class="sd">        Only needed if ground_nodes is True to find which nodes are to be</span>
<span class="sd">        grounded. Default: None.</span>

<span class="sd">    drain_nodes : list of tuples, optional</span>
<span class="sd">        If a drain node is supplied, the row and column corresponding to</span>
<span class="sd">        the drain node are zeros and a one is placed at the row-column</span>
<span class="sd">        intersection. Default: None.</span>

<span class="sd">    ground_nodes : bool, optional</span>
<span class="sd">        If true, a small value is added to the main diagonal to avoid</span>
<span class="sd">        singular matrices. Default: False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    M : csr_matrix</span>
<span class="sd">        Resultant sparse Laplacian matrix.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Error check</span>
    <span class="n">TYPES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">,</span> <span class="s2">&quot;capacitance&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">value_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TYPES</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid matrix type.&quot;</span><span class="p">)</span>

    <span class="c1"># Default values</span>
    <span class="k">if</span> <span class="n">source_nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">source_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">drain_nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">drain_nodes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Get Laplacian matrix</span>
    <span class="n">nodelist</span> <span class="o">=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">nodelist_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodelist</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">laplacian_matrix</span><span class="p">(</span><span class="n">NWN</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">value_type</span><span class="p">)</span>

    <span class="c1"># Ground every node with a huge resistor/tiny capacitor</span>
    <span class="k">if</span> <span class="n">ground_nodes</span><span class="p">:</span>
        <span class="c1"># Get list of node indices which are not connected to an electrode</span>
        <span class="n">unconnected_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span>
                    <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">][</span><span class="n">node</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">get_connected_nodes</span><span class="p">(</span>
                        <span class="n">NWN</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">source_nodes</span><span class="p">,</span> <span class="o">*</span><span class="n">drain_nodes</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">small</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nodelist_len</span><span class="p">)</span>
        <span class="n">small</span><span class="p">[</span><span class="n">unconnected_indices</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-12</span>

        <span class="c1"># Add small value to diagonal, grounding all non-connected nodes</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">dia_matrix</span><span class="p">(</span>
            <span class="p">(</span><span class="n">small</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nodelist_len</span><span class="p">,</span> <span class="n">nodelist_len</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Zero each of the drain nodes&#39; row and column</span>
    <span class="k">for</span> <span class="n">drain</span> <span class="ow">in</span> <span class="n">drain_nodes</span><span class="p">:</span>
        <span class="c1"># Change to lil since csr sparsity changes are expensive</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tolil</span><span class="p">()</span>
        <span class="n">drain_index</span> <span class="o">=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">][</span><span class="n">drain</span><span class="p">]</span>
        <span class="n">M</span><span class="p">[</span><span class="n">drain_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">M</span><span class="p">[:,</span> <span class="n">drain_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">M</span><span class="p">[</span><span class="n">drain_index</span><span class="p">,</span> <span class="n">drain_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">M</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mnns.calculations.get_connected_nodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_connected_nodes</span>


<a href="#mnns.calculations.get_connected_nodes" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_connected_nodes</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span> <span class="n">connected</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a list of nodes which are connected to any of the given nodes.</p>


            <details class="quote">
              <summary>Source code in <code>mnns/calculations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_connected_nodes</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span> <span class="n">connected</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of nodes which are connected to any of the given nodes.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nodelist</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">NWN</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">node</span> <span class="ow">in</span> <span class="n">subset</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">connected</span><span class="p">):</span>
            <span class="n">nodelist</span> <span class="o">=</span> <span class="n">nodelist</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nodelist</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mnns.calculations.scale_sol" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">scale_sol</span>


<a href="#mnns.calculations.scale_sol" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scale_sol</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span> <span class="n">sol</span><span class="p">:</span> <span class="n">NDArray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Scale the voltage and current solutions by their characteristic values.</p>


            <details class="quote">
              <summary>Source code in <code>mnns/calculations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scale_sol</span><span class="p">(</span><span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span> <span class="n">sol</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scale the voltage and current solutions by their characteristic values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get parameters</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
    <span class="n">v0</span> <span class="o">=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">][</span><span class="s2">&quot;v0&quot;</span><span class="p">]</span>
    <span class="n">i0</span> <span class="o">=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">][</span><span class="s2">&quot;i0&quot;</span><span class="p">]</span>
    <span class="n">node_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">])</span>

    <span class="c1"># Current sources</span>
    <span class="k">if</span> <span class="n">node_num</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">*=</span> <span class="n">v0</span>

    <span class="c1"># Voltage sources</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out</span><span class="p">[:</span><span class="n">node_num</span><span class="p">]</span> <span class="o">*=</span> <span class="n">v0</span>
        <span class="n">out</span><span class="p">[</span><span class="n">node_num</span><span class="p">:]</span> <span class="o">*=</span> <span class="n">i0</span>

    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mnns.calculations.solve_drain_current" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">solve_drain_current</span>


<a href="#mnns.calculations.solve_drain_current" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">solve_drain_current</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">voltage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Solve for the current through each drain node of a NWN.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>NWN</code>
            </td>
            <td>
                  <code><span title="Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nanowire network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Voltage source nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drain_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grounded output nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>voltage</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Voltage of the source nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scaled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to scaled the output by i0. Default: False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of sparse matrix solving algorithm to use. Default: "spsolve".</p>
              </div>
            </td>
            <td>
                  <code>&#39;spsolve&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>current_array</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array containing the current flow through each drain node in the order
passed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>mnns/calculations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_drain_current</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">voltage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve for the current through each drain node of a NWN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    NWN : Graph</span>
<span class="sd">        Nanowire network.</span>

<span class="sd">    source_node : tuple, or list of tuples</span>
<span class="sd">        Voltage source nodes.</span>

<span class="sd">    drain_node : tuple, or list of tuples</span>
<span class="sd">        Grounded output nodes.</span>

<span class="sd">    voltage : float</span>
<span class="sd">        Voltage of the source nodes.</span>

<span class="sd">    scaled : bool, optional</span>
<span class="sd">        Whether or not to scaled the output by i0. Default: False.</span>

<span class="sd">    solver: str, optional</span>
<span class="sd">        Name of sparse matrix solving algorithm to use. Default: &quot;spsolve&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    current_array : ndarray</span>
<span class="sd">        Array containing the current flow through each drain node in the order</span>
<span class="sd">        passed.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get lists of source and drain nodes</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_node</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">source_node</span> <span class="o">=</span> <span class="p">[</span><span class="n">source_node</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drain_node</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">drain_node</span> <span class="o">=</span> <span class="p">[</span><span class="n">drain_node</span><span class="p">]</span>

    <span class="c1"># Preallocate output</span>
    <span class="n">current_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drain_node</span><span class="p">))</span>

    <span class="c1"># Solve nodes</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">solve_network</span><span class="p">(</span>
        <span class="n">NWN</span><span class="p">,</span> <span class="n">source_node</span><span class="p">,</span> <span class="n">drain_node</span><span class="p">,</span> <span class="n">voltage</span><span class="p">,</span> <span class="s2">&quot;voltage&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="c1"># Find current through each drain node</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">drain</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">drain_node</span><span class="p">):</span>
        <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">NWN</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">drain</span><span class="p">):</span>
            <span class="n">V</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">NWN</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">node</span><span class="p">)]</span>
            <span class="n">R</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">NWN</span><span class="o">.</span><span class="n">edges</span><span class="p">[(</span><span class="n">node</span><span class="p">,</span> <span class="n">drain</span><span class="p">)][</span><span class="s2">&quot;conductance&quot;</span><span class="p">]</span>
            <span class="n">I</span> <span class="o">+=</span> <span class="n">V</span> <span class="o">/</span> <span class="n">R</span>
        <span class="n">current_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span>

    <span class="c1"># Scale the output if desired</span>
    <span class="k">if</span> <span class="n">scaled</span><span class="p">:</span>
        <span class="n">current_array</span> <span class="o">*=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">][</span><span class="s2">&quot;i0&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">current_array</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mnns.calculations.solve_edge_current" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">solve_edge_current</span>


<a href="#mnns.calculations.solve_edge_current" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">solve_edge_current</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">voltage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Solve for the current passing through each edge of a NWN. The direction is
not considered, only the magnitude.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>NWN</code>
            </td>
            <td>
                  <code><span title="Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nanowire network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Voltage source nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drain_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grounded output nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>voltage</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Voltage of the source nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scaled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to scaled the output by i0. Default: False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of sparse matrix solving algorithm to use. Default: "spsolve".</p>
              </div>
            </td>
            <td>
                  <code>&#39;spsolve&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>I</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array containing the current flow through each edge.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>mnns/calculations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_edge_current</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">voltage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve for the current passing through each edge of a NWN. The direction is</span>
<span class="sd">    not considered, only the magnitude.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    NWN : Graph</span>
<span class="sd">        Nanowire network.</span>

<span class="sd">    source_node : tuple, or list of tuples</span>
<span class="sd">        Voltage source nodes.</span>

<span class="sd">    drain_node : tuple, or list of tuples</span>
<span class="sd">        Grounded output nodes.</span>

<span class="sd">    voltage : float</span>
<span class="sd">        Voltage of the source nodes.</span>

<span class="sd">    scaled : bool, optional</span>
<span class="sd">        Whether or not to scaled the output by i0. Default: False.</span>

<span class="sd">    solver: str, optional</span>
<span class="sd">        Name of sparse matrix solving algorithm to use. Default: &quot;spsolve&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    I : ndarray</span>
<span class="sd">        Array containing the current flow through each edge.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get nodal voltages</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_network</span><span class="p">(</span>
        <span class="n">NWN</span><span class="p">,</span> <span class="n">source_node</span><span class="p">,</span> <span class="n">drain_node</span><span class="p">,</span> <span class="n">voltage</span><span class="p">,</span> <span class="s2">&quot;voltage&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="c1"># Get edges and conductances</span>
    <span class="n">edges</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">NWN</span><span class="p">,</span> <span class="s2">&quot;conductance&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="c1"># Find edges indices</span>
    <span class="n">start_nodes</span><span class="p">,</span> <span class="n">end_nodes</span> <span class="o">=</span> <span class="n">get_edge_indices</span><span class="p">(</span><span class="n">NWN</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>

    <span class="c1"># Find current through each edges</span>
    <span class="n">v0</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">start_nodes</span><span class="p">]</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">end_nodes</span><span class="p">]</span>
    <span class="n">V_delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v0</span> <span class="o">-</span> <span class="n">v1</span><span class="p">)</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">V_delta</span> <span class="o">*</span> <span class="n">G</span>

    <span class="c1"># Scale the output if desired</span>
    <span class="k">if</span> <span class="n">scaled</span><span class="p">:</span>
        <span class="n">I</span> <span class="o">*=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">][</span><span class="s2">&quot;i0&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">I</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mnns.calculations.solve_network" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">solve_network</span>


<a href="#mnns.calculations.solve_network" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">solve_network</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="nb">input</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;voltage&quot;</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Solve for the voltages of each node in a given NWN. Each drain node will
be grounded. If the type is "voltage", each source node will be at the
specified input voltage. If the type is "current", current will be sourced
from each source node.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>NWN</code>
            </td>
            <td>
                  <code><span title="Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nanowire network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Voltage/current source nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drain_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grounded output nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Supplied voltage (current) in units of v0 (i0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type</code>
            </td>
            <td>
                  <code>(&#39;voltage&#39;, &#39;current&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input type. Default: "voltage".</p>
              </div>
            </td>
            <td>
                  <code>&#34;voltage&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of sparse matrix solving algorithm to use. Default: "spsolve".</p>
              </div>
            </td>
            <td>
                  <code>&#39;spsolve&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments passed to the solver.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output array containing the voltages of each node. If the input type
is voltage, the current is also in this array as the last element.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>mnns/calculations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_network</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="nb">input</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;voltage&quot;</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve for the voltages of each node in a given NWN. Each drain node will</span>
<span class="sd">    be grounded. If the type is &quot;voltage&quot;, each source node will be at the</span>
<span class="sd">    specified input voltage. If the type is &quot;current&quot;, current will be sourced</span>
<span class="sd">    from each source node.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    NWN : Graph</span>
<span class="sd">        Nanowire network.</span>

<span class="sd">    source_node : tuple, or list of tuples</span>
<span class="sd">        Voltage/current source nodes.</span>

<span class="sd">    drain_node : tuple, or list of tuples</span>
<span class="sd">        Grounded output nodes.</span>

<span class="sd">    input : float</span>
<span class="sd">        Supplied voltage (current) in units of v0 (i0).</span>

<span class="sd">    type : {&quot;voltage&quot;, &quot;current&quot;}, optional</span>
<span class="sd">        Input type. Default: &quot;voltage&quot;.</span>

<span class="sd">    solver: str, optional</span>
<span class="sd">        Name of sparse matrix solving algorithm to use. Default: &quot;spsolve&quot;.</span>

<span class="sd">    **kwargs</span>
<span class="sd">        Keyword arguments passed to the solver.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ndarray</span>
<span class="sd">        Output array containing the voltages of each node. If the input type</span>
<span class="sd">        is voltage, the current is also in this array as the last element.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get lists of source and drain nodes</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_node</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">source_node</span> <span class="o">=</span> <span class="p">[</span><span class="n">source_node</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drain_node</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">drain_node</span> <span class="o">=</span> <span class="p">[</span><span class="n">drain_node</span><span class="p">]</span>

    <span class="c1"># Pass to solvers</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;voltage&quot;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">_solve_voltage</span><span class="p">(</span>
            <span class="n">NWN</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">source_node</span><span class="p">,</span> <span class="n">drain_node</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;current&quot;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">_solve_current</span><span class="p">(</span>
            <span class="n">NWN</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">source_node</span><span class="p">,</span> <span class="n">drain_node</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mnns.calculations.solve_nodal_current" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">solve_nodal_current</span>


<a href="#mnns.calculations.solve_nodal_current" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">solve_nodal_current</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">voltage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Solve for the current entering each node of a NWN. Only the entering
current is considered since by Kirchoff's law, the sum of currents
entering a node must equal the sum of currents leaving a node.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>NWN</code>
            </td>
            <td>
                  <code><span title="Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nanowire network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Voltage source nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drain_node</code>
            </td>
            <td>
                  <code>tuple, or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grounded output nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>voltage</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Voltage of the source nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scaled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to scaled the output by i0. Default: False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of sparse matrix solving algorithm to use. Default: "spsolve".</p>
              </div>
            </td>
            <td>
                  <code>&#39;spsolve&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>current_array</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array containing the current flow entering each node.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>mnns/calculations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_nodal_current</span><span class="p">(</span>
    <span class="n">NWN</span><span class="p">:</span> <span class="n">NanowireNetwork</span><span class="p">,</span>
    <span class="n">source_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">drain_node</span><span class="p">:</span> <span class="n">NWNNode</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">NWNNode</span><span class="p">],</span>
    <span class="n">voltage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spsolve&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve for the current entering each node of a NWN. Only the entering</span>
<span class="sd">    current is considered since by Kirchoff&#39;s law, the sum of currents</span>
<span class="sd">    entering a node must equal the sum of currents leaving a node.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    NWN : Graph</span>
<span class="sd">        Nanowire network.</span>

<span class="sd">    source_node : tuple, or list of tuples</span>
<span class="sd">        Voltage source nodes.</span>

<span class="sd">    drain_node : tuple, or list of tuples</span>
<span class="sd">        Grounded output nodes.</span>

<span class="sd">    voltage : float</span>
<span class="sd">        Voltage of the source nodes.</span>

<span class="sd">    scaled : bool, optional</span>
<span class="sd">        Whether or not to scaled the output by i0. Default: False.</span>

<span class="sd">    solver: str, optional</span>
<span class="sd">        Name of sparse matrix solving algorithm to use. Default: &quot;spsolve&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    current_array : ndarray</span>
<span class="sd">        Array containing the current flow entering each node.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get nodal voltages</span>
    <span class="n">V_out</span> <span class="o">=</span> <span class="n">solve_network</span><span class="p">(</span>
        <span class="n">NWN</span><span class="p">,</span> <span class="n">source_node</span><span class="p">,</span> <span class="n">drain_node</span><span class="p">,</span> <span class="n">voltage</span><span class="p">,</span> <span class="s2">&quot;voltage&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="c1"># Preallocate output</span>
    <span class="n">current_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">NWN</span><span class="o">.</span><span class="n">nodes</span><span class="p">))</span>

    <span class="c1"># Calculate input current for each node</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">NWN</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="n">node_ind</span> <span class="o">=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">][</span><span class="n">node</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">NWN</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="n">edge0_ind</span> <span class="o">=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">][</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">edge1_ind</span> <span class="o">=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;node_indices&quot;</span><span class="p">][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">V_delta</span> <span class="o">=</span> <span class="n">V_out</span><span class="p">[</span><span class="n">edge1_ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">V_out</span><span class="p">[</span><span class="n">edge0_ind</span><span class="p">]</span>

            <span class="c1"># Only add current entering a node so we can see how much</span>
            <span class="c1"># current passes through. Else, we just get zero due to KCL.</span>
            <span class="k">if</span> <span class="n">V_delta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">current_array</span><span class="p">[</span><span class="n">node_ind</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">V_delta</span> <span class="o">*</span> <span class="n">NWN</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;conductance&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">voltage</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="c1"># Scale the output if desired</span>
    <span class="k">if</span> <span class="n">scaled</span><span class="p">:</span>
        <span class="n">current_array</span> <span class="o">*=</span> <span class="n">NWN</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">][</span><span class="s2">&quot;i0&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">current_array</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["search.suggest", "content.code.copy", "navigation.sections", "navigation.indexes", "navigation.instant"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>